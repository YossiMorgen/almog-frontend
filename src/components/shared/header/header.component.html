<mat-toolbar color="primary" [dir]="getDirection()">
  <!-- Side Nav Toggle Button -->
  <button mat-icon-button (click)="onToggleSideNav()" class="side-nav-toggle">
    <mat-icon>menu</mat-icon>
  </button>
  
  <!-- Tenant Name with Dropdown -->
  <button mat-button [matMenuTriggerFor]="tenantMenu" class="tenant-name-button">
    <mat-icon>business</mat-icon>
    <span class="tenant-name">{{ getTenantDisplayName() }}</span>
    <mat-icon>arrow_drop_down</mat-icon>
  </button>
  
  <mat-menu #tenantMenu="matMenu" class="tenant-dropdown-menu">
    <!-- Tenant List Section -->
    <div class="tenant-section">
      <div class="section-header">
        <mat-icon>business</mat-icon>
        <span i18n="@@header.tenants">Organizations</span>
      </div>
      
      <!-- Tenant Search -->
      <div class="tenant-search">
        <mat-icon>search</mat-icon>
        <input 
          matInput 
          [(ngModel)]="tenantSearchTerm" 
          (input)="onTenantSearchChange()"
          placeholder="Search organizations..."
          class="search-input"
        >
      </div>
      
      <!-- Tenant List -->
      <div class="tenant-list">
        <button 
          *ngFor="let tenant of filteredTenants" 
          mat-menu-item 
          (click)="selectTenant(tenant)"
          [class.selected]="currentTenant?.id === tenant.id"
        >
          <mat-icon>business</mat-icon>
          <span>{{ tenant.name }}</span>
          <mat-icon *ngIf="currentTenant?.id === tenant.id" class="check-icon">check</mat-icon>
        </button>
        
        <!-- Create New Organization Button -->
        <button mat-menu-item (click)="createNewOrganization()" class="create-organization-btn">
          <mat-icon>add</mat-icon>
          <span i18n="@@header.createOrganization">Create New Organization</span>
        </button>
      </div>
    </div>

    <mat-divider></mat-divider>

    <!-- User Profile Section -->
    <div class="user-profile-section">
      <div class="section-header">
        <mat-icon>person</mat-icon>
        <span>{{ currentUser?.email || 'User' }}</span>
      </div>
      
      <button mat-menu-item routerLink="/crm/profile">
        <mat-icon>person</mat-icon>
        <span i18n="@@header.profile">Profile</span>
      </button>
      <button mat-menu-item (click)="toggleTheme()">
        <mat-icon>{{ (themeService.isDarkTheme$ | async) ? 'light_mode' : 'dark_mode' }}</mat-icon>
        <span i18n="@@header.toggleTheme">Toggle Theme</span>
      </button>
      <button *ngIf="isLoggedIn" mat-menu-item (click)="signOut()">
        <mat-icon>logout</mat-icon>
        <span i18n="@@header.signOut">Sign Out</span>
      </button>
      <button *ngIf="!isLoggedIn" mat-menu-item (click)="signIn()">
        <mat-icon>login</mat-icon>
        <span i18n="@@header.signIn">Sign In</span>
      </button>
    </div>
  </mat-menu>
  
  <span class="spacer"></span>
  
  <!-- Filter Toggle Button -->
  <button *ngIf="showFilters$ | async" mat-icon-button (click)="onToggleFilters()" matTooltip="Toggle Filters" i18n-matTooltip="@@header.toggleFilters" class="filter-toggle">
    <mat-icon>filter_list</mat-icon>
  </button>
  
  <!-- Theme Toggle (moved to dropdown but keeping for mobile) -->
  <button mat-icon-button (click)="toggleTheme()" matTooltip="Toggle Theme" i18n-matTooltip="@@header.toggleTheme" class="mobile-theme-toggle">
    <mat-icon>{{ (themeService.isDarkTheme$ | async) ? 'light_mode' : 'dark_mode' }}</mat-icon>
  </button>
</mat-toolbar>
